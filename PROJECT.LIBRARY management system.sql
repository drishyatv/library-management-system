CREATE DATABASE LIBRARY;

USE LIBRARY;

CREATE TABLE BRANCH
(

Branch_no INT PRIMARY KEY,

Manager_id INT,

Branch_address VARCHARACTER(30),

Contact_no BIGINT

);


INSERT INTO BRANCH (Branch_no,Manager_id,Branch_address,Contact_no) VALUES(21,1121,'ROSE_BUILDING-THANA',7112213455);

INSERT INTO BRANCH (Branch_no,Manager_id,Branch_address,Contact_no) VALUES(22,1122,'APJ_BUILDING-CALTEX',7484451211);

INSERT INTO BRANCH (Branch_no,Manager_id,Branch_address,Contact_no) VALUES(34,1134,'EMPIRE_MALL-ANNUR',7123343455);

INSERT INTO BRANCH (Branch_no,Manager_id,Branch_address,Contact_no) VALUES(45,1145,'JJ_BUILDING-KANNUR',7005112255);

INSERT INTO BRANCH (Branch_no,Manager_id,Branch_address,Contact_no) VALUES(24,1124,'CAPITAL_MALL-THANA',8878126787);

INSERT INTO BRANCH (Branch_no,Manager_id,Branch_address,Contact_no) VALUES(23,1123,'SEE_BUILDING-PAYYAMBALAM',8222213455);

INSERT INTO BRANCH (Branch_no,Manager_id,Branch_address,Contact_no) VALUES(28,1128,'ANGEL_BUILDING-THALAP',8662213455);

SELECT * FROM BRANCH;



CREATE TABLE EMPLOYEE

(

Emp_id INT PRIMARY KEY,

Emp_name VARCHAR(20),

Position VARCHAR(20),

Salary INT,

Branch_no INT ,

FOREIGN KEY(Branch_no) REFERENCES BRANCH(Branch_no)

);


INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(111,'ANAND_K','LIBRARIAN',55000,22);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(121,'ABHILASH_M','LIBRARIAN',52000,28);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(131,'ULLAS_G','LIBRARIAN',50000,21);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(141,'ARUN_U','LIBRARIAN',40000,23);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(151,'SMITHA_K','LIBRARIAN',45000,24);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(161,'RIYA_P','LIBRARIAN',40000,34);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(171,'MIYA_N','LIBRARIAN',51000,45);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(211,'AMBIKA','DEPUTY_LIBRARIAN',35000,21);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(221,'GAYATHRI_R','DEPUTY_LIBRARIAN',35000,22);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(231,'SIVA_N','LIBRARY_ATTENDANT',25000,23);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(241,'ANITHA_R','LIBRARY_ASSISTANT',30000,24);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(251,'GANGA_C','DEPUTY_LIBRARIAN',37000,28);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(261,'ANAGHA_C','PROF_ASSISTANT',30000,34);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(271,'MAYA_DEVI','DEPUTY_LIBRARIAN',40000,45);

INSERT INTO EMPLOYEE(Emp_id,Emp_name,Position,Salary,Branch_no) VALUES(371,'NAINA_N','LIBRARY_ATTENDANT',25000,45);


SELECT * FROM EMPLOYEE;

SELECT Emp_name,Salary FROM EMPLOYEE ORDER BY Emp_name DESC;



CREATE TABLE BOOKS

(

ISBN INT PRIMARY KEY,

Book_title VARCHAR(30),

Category VARCHAR(20),

Rental_price INT,

Author VARCHAR(25),

Publisher VARCHAR(30)

);


INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(117,'MARTHANDAVARMA','NOVEL',100,'C_V_RAMANPILAI','KAMALALAYA');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(412,'WINGS_OF_FIRE','AUTOBIOGRAPHY',100,'APJ','UNIVERSTY_PRESS');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(512,'AADUJEEVITHAM','NOVEL',100,'BENYAMIN','PENGUIN_BOOKS');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(785,'PREMAEGHANAM','NOVEL',100,'BASHEER','DC_BOOKS');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(867,'DURAVASTHA','POEM',100,'KUMARANASAN','CHINTHA');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(903,'MATHIUKAL','NOVEL',100,'BASHEER','DC_BOOKS');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(932,'ENTE_JEEVITHA_KADHA','AUTOBIOGRAPHY',100,'AKG','CHINTHA');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(970,'JEEVITHAPATHA','NOVEL',100,'CHERUAD','CURRENT_BOOKS');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(4555,'MUTHASSI','SHORT_STORY',100,'CHERUAD','CURRENT_BOOKS');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(6677,'MARAYIATHE','SHORT_STORY',100,'JOHN_BRITTAS','MATHRUBHOOMI');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(95532,'VISHAPP','NOVEL',100,'BASHEER','DC_BOOKS');

INSERT INTO BOOKS(ISBN,Book_title,Category,Rental_price,Author,Publisher) VALUES(95552,'ORU_NAZHI_MANNU','DRAMA',100,'FRANCIS_T','KERALA_SN_ACADEMY');

SELECT * FROM BOOKS;

ALTER TABLE BOOKS ADD COLUMN STATUS VARCHAR(10);



SELECT * FROM BOOKS;

SELECT Book_title, COUNT(DISTINCT Book_title ) as 'AVAILABILITY' FROM BOOKSS GROUP BY Book_title  ;



CREATE TABLE CUSTOMER

(

Customer_id INT  PRIMARY KEY,

Customer_name VARCHAR(20),

Customer_address VARCHAR(30),

Reg_date DATETIME

);

INSERT INTO CUSTOMER VALUES(166,'HANA_M','FATHIMA_NIVAS_PARAYIL_KANNUR','2024-11-13');

INSERT INTO CUSTOMER VALUES(189,'TIYA_C','TIA_BHAVAN_IRINAVE_KANNUR','2022-10-09');

INSERT INTO CUSTOMER VALUES(171,'LAYA_K','THAREL_HOUSE_MAYYIL_KANNUR','2023-11-09');

INSERT INTO CUSTOMER VALUES(199,'FATHIMA_N','FATHIMA_NIVAS_MAYYIL_KANNUR','2022-11-09');

INSERT INTO CUSTOMER VALUES(299,'ANU_MATHEW','ANN_VILLA_MUTTAM_KANNUR','2022-11-14');

INSERT INTO CUSTOMER VALUES(866,'MANU_P','MANU_POYYIL_MAYYIL_KANNUR','2022-08-09');

INSERT INTO CUSTOMER VALUES(711,'RIYA_K','RIYA_NIVAS_VELAM_KANNUR','2022-08-23');

INSERT INTO CUSTOMER VALUES(199,'YAN_S','YAN_NIVAS_THAYYIL_KANNUR','2023-11-09');

INSERT INTO CUSTOMER VALUES(155,'NAYANA_P','VAYAYL_HOUSE_AROLI_PAYYANNUR','2022-09-09');


SELECT * FROM CUSTOMER;


CREATE TABLE ISSUE_STATUSS

(

Issue_id INT PRIMARY KEY,

Issued_cust INT,

FOREIGN KEY(Issued_cust) REFERENCES CUSTOMER(Customer_id),

Issued_book_name VARCHAR(30),

Issue_date DATE,

ISBN_book INT,

FOREIGN KEY(ISBN_book) REFERENCES BOOKS(ISBN)

);

DESC ISSUE_STATUSS;

INSERT INTO ISSUE_STATUSS VALUES(1001,166,'WINGS_OF_FIRE','2024-01-01',412);

INSERT INTO ISSUE_STATUSS VALUES(1002,166,'AADUJEEVITHAM','2023-01-01',512);

INSERT INTO ISSUE_STATUSS VALUES(1003,189,'PREMAEGHANAM','2023-01-01',785);

INSERT INTO ISSUE_STATUSS VALUES(1004,299,'MATHILUKAL','2023-01-10',903);

INSERT INTO ISSUE_STATUSS VALUES(1005,711,'MUTHASSI','2023-01-01',4555);

INSERT INTO ISSUE_STATUSS VALUES(1006,171,'VISHAPP','2023-01-01',95532);

INSERT INTO ISSUE_STATUSS VALUES(1007,866,'JEEVITHAPATHA','2023-01-01',412);

INSERT INTO ISSUE_STATUSS VALUES(1008,866,'DURAVASTHA','2023-01-01',867);

INSERT INTO ISSUE_STATUSS VALUES(1009,166,'MARAYIATHE','2023-01-01',6677);

SELECT * FROM ISSUE_STATUSS;


CREATE TABLE RETURN_STATUS

(

Return_id INT PRIMARY KEY,

Return_cust VARCHAR(20),

Return_book_name VARCHAR(20),

Return_date DATE,

ISBN_BOOK2 INT,

FOREIGN KEY(ISBN_BOOK2) REFERENCES BOOKS(ISBN)

);

DESC RETURN_STATUS;


INSERT INTO RETURN_STATUS VALUES(2001,166,'AADUJEEVITHAM','2024-05-25',512);

INSERT INTO RETURN_STATUS VALUES(2002,866,'DURAVASTHA','2024-05-15',867);

INSERT INTO RETURN_STATUS VALUES(2003,866,'JEEVITHAPATHA','2024-08-06',412);

INSERT INTO RETURN_STATUS VALUES(2004,189,'PREMAEGHANAM','2024-10-10',785);

INSERT INTO RETURN_STATUS VALUES(2005,299,'MATHILUKAL','2024-01-05',903);

SELECT * FROM  RETURN_STATUS;

SELECT * FROM ISSUE_STATUSS;

SELECT Issued_cust,Issued_book_name FROM ISSUE_STATUSS;

SELECT Category,COUNT(DISTINCT Book_title) FROM BOOKS GROUP BY Category;

SELECT Emp_name,Position  FROM Employee WHERE Salary > 50000;



SELECT Customer_id,CUSTOMER.Customer_name,CUSTOMER.Reg_date ,ISSUE_STATUSS.Issued_cust,ISSUE_STATUSS.Issued_book_name,ISSUE_STATUSS.Issue_date FROM ISSUE_STATUSS inner JOIN CUSTOMER ON  Customer_id =Issued_cust;


UPDATE ISSUE_STATUSS SET Issue_date = '2024-12-30'  WHERE Issued_cust=166 ;

UPDATE ISSUE_STATUSS SET Issue_date = '2024-12-30'  WHERE Issued_cust=299 ;

UPDATE ISSUE_STATUSS SET Issue_date = '2024-12-30'  WHERE Issued_cust=866 ;

UPDATE CUSTOMER SET Reg_date = '2021-12-30'  WHERE Customer_id=166 ;

UPDATE CUSTOMER SET Reg_date = '2021-12-30'  WHERE Customer_id=155 ;

SELECT Customer_id,CUSTOMER.Customer_name,CUSTOMER.Reg_date ,ISSUE_STATUSS.Issued_cust,ISSUE_STATUSS.Issued_book_name,ISSUE_STATUSS.Issue_date FROM ISSUE_STATUSS inner JOIN CUSTOMER ON  Customer_id =Issued_cust;

SELECT Customer_id,CUSTOMER.Customer_name,CUSTOMER.Reg_date ,ISSUE_STATUSS.Issued_cust,ISSUE_STATUSS.Issued_book_name,ISSUE_STATUSS.Issue_date FROM ISSUE_STATUSS RIGHT JOIN CUSTOMER ON  Customer_id =Issued_cust;

UPDATE BOOKS SET Status = 'NO' where ISBN = NULL;

UPDATE BOOKS SET Status = 'YES' where ISBN >0;

#QUESTION 1

SELECT Book_title,Category,Rental_price FROM BOOKS WHERE Status = 'yes';   


#QUESTION 2

SELECT Emp_name,Salary FROM EMPLOYEE ORDER BY Salary DESC;

#question 3


SELECT Issued_book_name,Customer_name FROM ISSUE_STATUSS LEFT JOIN CUSTOMER ON Issued_cust = Customer_id;


#question 4


SELECT Category,count(*) AS 'TOTAL BOOKS' FROM BOOKS GROUP BY Category;


#question 5


SELECT Emp_name,Position FROM EMPLOYEE WHERE Salary > 50000;


#question 6


SELECT Customer_name FROM CUSTOMER WHERE Customer_id NOT IN(SELECT Issued_cust FROM ISSUE_STATUS) AND Reg_date < '2022-01-01';


SELECT Customer_name FROM CUSTOMER LEFT JOIN ISSUE_STATUS ON Issued_cust = Customer_id WHERE Reg_date < '2022-01-01';



#question 7

SELECT Branch_no,count(*) AS 'TOTAL EMPLOYEES' FROM EMPLOYEE GROUP BY Branch_no;


# QUESTION 8



SELECT DISTINCT Customer_name FROM ISSUE_STATUSS LEFT JOIN CUSTOMER C  ON I.Issued_cust = C.Customer_id WHERE I.Issue_date BETWEEN '2024-01-01' AND '2024-05-30';



#QUESTION 9



SELECT Book_title  FROM BOOKS WHERE Book_title like  '%VISHAPP%';




#question 10



SELECT Branch_no,count(*) AS 'COUNT OF EMPLOYEES' FROM EMPLOYEE GROUP BY Branch_no  HAVING count(*) > 2;



#QUESTION 11



SELECT E.Emp_name,b.Branch_address FROM EMPLOYEE  E
LEFT JOIN  BRANCH b ON E.Branch_no = b.Branch_no WHERE E.Position ='LIBRARIAN';



#QUESTION 12


SELECT DISTINCT C.Customer_name FROM ISSUE_STATUSS I
LEFT JOIN  Books b ON I.ISBN_Book =b.ISBN
LEFT JOIN Customer C ON I.Issued_cust = C.Customer_id WHERE b.Rental_price >25;